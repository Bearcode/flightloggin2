{% extends "base.html" %}
{% block records-sel %}nav_selected{% endblock%}

{% block javascript %}
    <script type="text/javascript" src="{{ MEDIA_URL }}/javascripts/popup.js"></script>
    <script type="text/javascript" src="{{ MEDIA_URL }}/javascripts/new_event_popup.js"></script>
	<script type="text/javascript">
	    $(document).ready(function() {
	        $("input[id$=date]").datepicker({
			        dateFormat: "yy-mm-dd",
			        yearRange: "-80:+1", 
			        showOn: "button", 
			        buttonImage: "{{ MEDIA_URL }}/images/calendar.gif", 
			        buttonImageOnly: true 
	        }).addClass("embed");
	        
	        
	        $("#nonflight_table a").click(function() {
	        
	            prepare_edit_event(true);
	            fill_in_event(this.id);
	            fire_popup();
	    
	        });
	        
	        $("#new_event").click(function() {
	        
	            prepare_new_event(true);
	            
	            fire_popup();
	    
	        });
	        
	    });
    
	</script>
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}/css/records.css">
	<link rel="stylesheet" type="text/css" href="{{ MEDIA_URL }}/css/popup.css">
{% endblock %}

{% block title %}Records{% endblock %}

{% block canvas %}
	<div id="nonflights_instructions">
		<input type="button" id="new_event" value="New Event">
	</div>
	
<form action="{% url records display_user %}" method="post">
    <table id="nonflight_table">
       <tr>
           <td>Date{{formset.management_form}}</td><td>Type</td><td>Remarks</td>
       </tr>
    {% for nf in nonflights %}
       <tr id="row_{{nf.id}}">
           <td class="date" title="Date (click to edit)"><span class="unformatted_date">{{nf.date}}</span><a id="n{{nf.id}}" href="">{{ nf.date|date:date_format }}</a></td>
           <td class="non_flying">{{ nf.get_non_flying_display }}</td>
           <td class="remarks">{{ nf.remarks }}</td>
       </tr>
    {% empty %}
    
       <tr><td>Nothing to show here</td></tr>
       
    {% endfor %}    
    </table>
    

	<div id="records_instructions">
		Use this space to record any information you'd normally put in the back of a paper logbook.
		Phone numbers and addresses of contacts; dates of endorsements; student signoffs and outcomes; notes, etc.
	</div>
	
	<br>

	<div>
		<textarea style="width:80%;height:400px" cols="50" rows="10" name="records">{{ records.text }}</textarea>

		<br>
		<br>

		<input type="submit" value="Save" />
		
		{% if saved %}
		
		<br /><br />
		<span style="color: red; font-weight: bold">Saved</span>
		
		{% endif %}

	</div>
</form>

<div id="popup" title="New Entry">
	<table id="dragbar">
		<tr>
			<td><span id="titlebar">New Event</span></td>
			<td><span id="close_x" title="Close this popup">[X]</span></td>
		</tr>
	</table>
	
	<form id="new_plane_form" action="{% url records user.username %}" method="post">
		<table>
			<tbody>
				<tr>
					<td>		
						{# <input type="hidden" name="user" id="id_user" value="{{ user.id }}" /> #}
						<input type="hidden" name="id" id="id_id" value="" />
					</td>
				</tr>
				<tr>
					<td>{{ form.date.label_tag }}</td>
					<td>{{ form.date }}<br><span class="help_text">{{form.date.help_text}}</span></td>
				</tr>
				<tr>
					<td>Event</td>
					<td>{{ form.non_flying }}<br><span class="help_text">{{form.non_flying.help_text}}</span></td>
				</tr>
			
				<tr>
					<td>{{ form.remarks.label_tag }}</td>
					<td>{{ form.remarks }}<br><span class="help_text">{{form.remarks.help_text}}</span></td>
				</tr>
			</tbody>
		</table>
		
    	<div id="new_buttons">
			<input type="submit" name="submit" value="Create New Event" />
		</div>

		<div id="edit_buttons">
			<input type="submit" name="submit" value="Submit Changes" />
			<input type="submit" name="submit" value="Delete Event" />
		</div>

	</form>
</div>


{% endblock %}
